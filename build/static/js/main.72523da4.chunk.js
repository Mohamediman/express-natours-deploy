(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[1],{15:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u}));var r="GET_TOURS",a="GET_TOUR",c="TOUR_ERRORS",o="TOURS_ERRORS",s="LOAD_TOUR",u="BOOKTOUR"},19:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(98),a=n(27),c=function(e,t){return function(n){var c=Object(r.a)();console.log("Set Alert called here.."),n({type:a.b,payload:{msg:e,alertType:t,id:c}}),setTimeout((function(){return n({type:a.a,payload:c})}),5e3)}}},20:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));var r=n(28),a=function(e){return e.auth},c=Object(r.a)(a,(function(e){return e.isAuthenticated})),o=Object(r.a)(a,(function(e){return e.user}))},25:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return O}));var r=n(6),a=n.n(r),c=n(17),o=n(12),s=n.n(o),u=n(16),i=n.n(u),l=n(5),d=n(19),p=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{"Content-Type":"application/json"}},e.next=4,s.a.get("/api/v1/users/me",n);case 4:r=e.sent,t({type:l.e,payload:r.data.data.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error from loading the user",e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},b=function(e,t){return function(){var n=Object(c.a)(a.a.mark((function n(r){var c,o,u;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c={headers:{"Content-Type":"application/json"}},o=JSON.stringify({email:e,password:t}),n.prev=2,n.next=5,s.a.post("/api/v1/users/login",o,c);case 5:u=n.sent,r(Object(d.a)("Success Login","success")),i.a.set("jwt",u.data.token,{expires:7}),r({type:l.e,payload:u.data.data.user}),n.next=17;break;case 11:n.prev=11,n.t0=n.catch(2),i.a.remove("jwt"),console.log(n.t0.response),r({type:l.b}),r({type:l.a});case 17:case"end":return n.stop()}}),n,null,[[2,11]])})));return function(e){return n.apply(this,arguments)}}()},j=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{"Content-Type":"application/json"}},c=JSON.stringify(e),t.prev=2,t.next=5,s.a.post("/api/v1/users/signup",c,r);case 5:o=t.sent,n(Object(d.a)("Success Register","success")),i.a.set("jwt",o.data.token,{expires:7}),n({type:l.e,payload:o.data.data.user}),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(2),n(Object(d.a)(t.t0.response.data.message,"error")),i.a.remove("jwt"),n({type:l.b}),n({type:l.a});case 17:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()},f=function(){return function(e){i.a.remove("jwt"),e({type:l.f})}},h=function(e,t,n){return function(){var r=Object(c.a)(a.a.mark((function r(c){var o,u;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(o=new FormData).append("photo",n),o.append("name",e),o.append("email",t),r.prev=4,r.next=7,s.a.patch("/api/v1/users/updateMe",o);case 7:u=r.sent,c(Object(d.a)("User Updated Successfully","success")),c({type:l.c,payload:u.data.data.user}),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(4),c(Object(d.a)(r.t0.response.data.message,"error"));case 15:case"end":return r.stop()}}),r,null,[[4,12]])})));return function(e){return r.apply(this,arguments)}}()},O=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{"Content-Type":"application/json"}},c=JSON.stringify(e),t.prev=2,t.next=5,s.a.patch("/api/v1/users/updateMyPassword",c,r);case 5:o=t.sent,n(Object(d.a)("Password update Success","success")),n({type:l.d,payload:o.data.data.user}),n({type:l.f}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),n(Object(d.a)(t.t0.response.data.message,"error"));case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()}},27:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="SET_ALERT",a="REMOVE_ALERT"},30:function(e,t,n){"use strict";n(0);var r,a,c=n(22),o=n(23),s=o.a.div(r||(r=Object(c.a)(["\n  height: 60vh;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),u=o.a.div(a||(a=Object(c.a)(["\n  display: inline-block;\n  width: 50px;\n  height: 50px;\n  border: 3px solid rgba(195, 195, 195, 0.6);\n  border-radius: 50%;\n  border-top-color: #636767;\n  animation: spin 1s ease-in-out infinite;\n  -webkit-animation: spin 1s ease-in-out infinite;\n  @keyframes spin {\n    to {\n      -webkit-transform: rotate(360deg);\n    }\n  }\n  @-webkit-keyframes spin {\n    to {\n      -webkit-transform: rotate(360deg);\n    }\n  }\n"]))),i=n(1);t.a=function(){return Object(i.jsx)(s,{children:Object(i.jsx)(u,{})})}},32:function(e,t,n){"use strict";var r=n(12),a=n.n(r);t.a=function(e){e?a.a.defaults.headers.common.authorization="Bearer ".concat(e):delete a.a.defaults.common.authorization}},36:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return f}));var r=n(6),a=n.n(r),c=n(17),o=n(12),s=n.n(o),u=n(60),i=n(15),l=n(32),d=Object(u.a)("pk_test_51JRSF2AJHQSuL36xgVLN3iL6uDsgccyG5gdbXPzBwPb6PXXRGG5LPet9720qWUKB7zJ9Hkar7B4fqXs55txpLiBd00x57dIp8g"),p=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.get("/api/v1/tours");case 3:n=e.sent,t({type:i.c,payload:n.data.data.data}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),t({type:i.e,payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},b=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.get("/api/v1/tour/".concat(e));case 3:r=t.sent,n({type:i.b,payload:r.data.tour}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n({type:i.f,payload:t.t0.response});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},j=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.token&&Object(l.a)(localStorage.token),t.prev=1,t.next=4,s.a.get("/api/v1/bookings/checkout-session/".concat(e));case 4:return r=t.sent,t.next=7,d;case 7:return t.next=9,t.sent.redirectToCheckout({sessionId:r.data.session.id});case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log("SESSION ERROR MESSAGE:",t.t0.response);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()},f=function(){return function(e){localStorage.tour&&e({type:i.d,payload:localStorage.tour})}}},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="GET_BOOKINGS"},5:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var r="USER_LOADED",a="UPDATE_CURRENT_USER",c="UPDATE_USER_PASSWORD",o="USER_LOGOUT",s="CLEAR_USER",u="AUTH_ERROR"},55:function(e,t,n){"use strict";t.a=n.p+"static/media/logo-white.6c89a3f0.png"},75:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var r=n(31),a=n.n(r),c=n(10),o=n(11),s=n(26),u=n(57),i=n(58),l=n(56),d=n(27),p=[];var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case d.b:return[].concat(Object(l.a)(e),[r]);case d.a:return e.filter((function(e){return e.id!==r}));default:return e}},j=n(3),f=n(5),h={user:null,isAuthenticated:!1};var O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.e:case f.c:case f.d:return Object(j.a)(Object(j.a)({},e),{},{user:t.payload,isAuthenticated:!0});case f.a:case f.b:case f.f:return Object(j.a)(Object(j.a)({},e),{},{user:null,isAuthenticated:!1});default:return e}},v=n(15),g={tours:[],tour:null,toursBooked:null,loading:!0,errors:null};var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.c:return Object(j.a)(Object(j.a)({},e),{},{tours:t.payload,loading:!1,errors:null});case v.b:return Object(j.a)(Object(j.a)({},e),{},{tour:t.payload,errors:null,loading:!1});case v.d:return Object(j.a)(Object(j.a)({},e),{},{tour:JSON.parse(t.payload),errors:null,loading:!1});case v.a:return Object(j.a)(Object(j.a)({},e),{},{toursBooked:t.payload,errors:null,loading:!1});case v.e:return Object(j.a)(Object(j.a)({},e),{},{tours:[],tour:null,errors:t.payload,loading:!1});case v.f:return Object(j.a)(Object(j.a)({},e),{},{tour:null,errors:t.payload,loading:!1});default:return e}},m=n(45),y={toursBooked:null};var k,w,_,S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;return t.type===m.a?Object(j.a)(Object(j.a)({},e),{},{toursBooked:t.payload}):e},R=Object(s.combineReducers)({tours:x,auth:O,bookings:S,alerts:b}),E=[i.a],T=Object(s.createStore)(R,{},Object(u.composeWithDevTools)(s.applyMiddleware.apply(void 0,E))),A=n(0),U=n(4),N=n(16),C=n.n(N),L=(n(75),n.p+"static/media/logo-green.de221e6e.png"),P=n(1),B=function(){return Object(P.jsxs)("div",{className:"footer",children:[Object(P.jsx)("div",{className:"footer__logo",children:Object(P.jsx)(o.b,{to:"/",children:Object(P.jsx)("img",{src:L,alt:"logo"})})}),Object(P.jsxs)("ul",{className:"footer__nav",children:[Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"About us"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Download apps"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Become a guide"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Careers"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Contact"})})]}),Object(P.jsx)("p",{className:"footer__copyright",children:"\xa9 by Mohamed Iman Portfolio. All rights reserved."})]})},z=n(65),D=n(20),G=["component","isAuthenticated"],J=Object(c.b)((function(e){return{isAuthenticated:Object(D.b)(e)}}))((function(e){var t=e.component,n=e.isAuthenticated,r=Object(z.a)(e,G);return Object(P.jsx)(U.b,Object(j.a)(Object(j.a)({},r),{},{render:function(e){return n?Object(P.jsx)(t,Object(j.a)({},e)):Object(P.jsx)(U.a,{to:"/login"})}}))})),I=n(36),M=n(25),F=Object(c.b)((function(e){return{alerts:e.alerts}}))((function(e){var t=e.alerts;return null!==t&&t.length>0&&t.map((function(e){return Object(P.jsxs)("div",{className:"alert alert--".concat(e.alertType),children:[" ",e.msg]},e.id)}))})),W=n(28),X=n(30),H=Object(c.b)(null,{logout:M.d})((function(e){var t=e.logout,n=Object(W.b)({isAuthenticated:D.b,user:D.a}),r=Object(c.c)(n),a=r.isAuthenticated,s=r.user,u=Object(P.jsxs)("nav",{className:"nav nav--user",children:[Object(P.jsx)("a",{href:"/",className:"nav__el nav__el--logout",onClick:t,children:"Log Out"}),Object(P.jsxs)(o.b,{to:"/me",className:"nav__el",children:[s?Object(P.jsx)("img",{src:"/img/users/".concat(s.photo),alt:"user",className:"nav__user-img"}):Object(P.jsx)(X.a,{}),s&&s.name&&Object(P.jsx)("span",{children:s.name.split(" ")[0]})]})]}),i=Object(P.jsxs)("nav",{className:"nav nav--user",children:[Object(P.jsx)(o.b,{to:"/login",className:"nav__el",children:"Log in"}),Object(P.jsx)(o.b,{to:"/signup",className:"nav__el nav__el--cta",children:"Sign up"})]});return Object(P.jsx)(A.Fragment,{children:a?u:i})})),K=n(55),q=Object(c.b)((function(e){return{isAuthenticated:Object(D.b)(e)}}),{loadUser:M.b})((function(e){e.isAuthenticated;var t=e.loadUser;return Object(A.useEffect)((function(){C.a.get("jwt")&&(t(),console.log("Called the loadUser"))}),[]),Object(P.jsxs)("header",{className:"header",children:[Object(P.jsx)(o.b,{to:"/",className:"nav__el",children:"All tours"}),Object(P.jsx)("div",{className:"header__logo",children:Object(P.jsx)(o.b,{to:"/",children:Object(P.jsx)("img",{src:K.a,alt:"Natours logo"})})}),Object(P.jsx)(H,{})]})})),V=n(32),Q=n(40),Y=n(41),Z=n(66),$=n(64),ee=n(22),te=n(23),ne=te.a.div(k||(k=Object(ee.a)(["\n  height: 60vh;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]))),re=te.a.div(w||(w=Object(ee.a)(["\n  display: inline-block;\n  background-image: ",";\n  background-size: cover;\n  background-position: center;\n  width: 40vh;\n  height: 40vh;\n"])),(function(e){var t=e.imageUrl;return"url(".concat(t,")")})),ae=te.a.h2(_||(_=Object(ee.a)(["\n  font-size: 28px;\n  color: #2f8e89;\n"]))),ce=function(e){Object(Z.a)(n,e);var t=Object($.a)(n);function n(){var e;return Object(Q.a)(this,n),(e=t.call(this)).state={hasErrored:!1},e}return Object(Y.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e)}},{key:"render",value:function(){return this.state.hasErrored?Object(P.jsxs)(ne,{children:[Object(P.jsx)(re,{imageUrl:"https://i.imgur.com/yW2W9SC.png"}),Object(P.jsx)(ae,{children:"Sorry this page is broken"})]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasErrored:!0}}}]),n}(A.Component),oe=Object(A.lazy)((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,126))})),se=Object(A.lazy)((function(){return Promise.all([n.e(0),n.e(4),n.e(10)]).then(n.bind(null,129))})),ue=Object(A.lazy)((function(){return n.e(7).then(n.bind(null,127))})),ie=Object(A.lazy)((function(){return n.e(8).then(n.bind(null,128))})),le=Object(A.lazy)((function(){return Promise.all([n.e(5),n.e(11)]).then(n.bind(null,130))})),de=Object(A.lazy)((function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,131))})),pe=Object(c.b)(null,{loadUser:M.b,getAllTours:I.b,loadTour:I.d})((function(e){var t=e.loadUser,n=e.getAllTours,r=e.loadTour;return C.a.get("jwt")&&(Object(V.a)(C.a.get("jwt")),t()),Object(A.useEffect)((function(){n(),r()}),[]),Object(P.jsxs)(A.Fragment,{children:[Object(P.jsx)(q,{}),Object(P.jsx)(F,{}),Object(P.jsx)(U.d,{children:Object(P.jsx)(ce,{children:Object(P.jsxs)(A.Suspense,{fallback:X.a,children:[Object(P.jsx)(J,{exact:!0,path:"/me",component:le}),Object(P.jsx)(J,{exact:!0,path:"/bookings/my-tours",component:de}),Object(P.jsx)(U.b,{exact:!0,path:"/",component:oe}),Object(P.jsx)(U.b,{exact:!0,path:"/tour/:slug",component:se}),Object(P.jsx)(U.b,{exact:!0,path:"/login",component:ue}),Object(P.jsx)(U.b,{exact:!0,path:"/signup",component:ie})]})})}),Object(P.jsx)(B,{})]})}));a.a.render(Object(P.jsx)(c.a,{store:T,children:Object(P.jsx)(o.a,{children:Object(P.jsx)(pe,{})})}),document.getElementById("root"))}},[[97,2,3]]]);
//# sourceMappingURL=main.72523da4.chunk.js.map