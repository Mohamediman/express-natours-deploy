(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[1],{15:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u}));var r="GET_TOURS",a="GET_TOUR",c="TOUR_ERRORS",o="TOURS_ERRORS",s="LOAD_TOUR",u="BOOKTOUR"},20:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(99),a=n(28),c=function(e,t){return function(n){var c=Object(r.a)();console.log("Set Alert called here.."),n({type:a.b,payload:{msg:e,alertType:t,id:c}}),setTimeout((function(){return n({type:a.a,payload:c})}),5e3)}}},21:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));var r=n(29),a=function(e){return e.auth},c=Object(r.a)(a,(function(e){return e.isAuthenticated})),o=Object(r.a)(a,(function(e){return e.user}))},26:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return O}));var r=n(7),a=n.n(r),c=n(18),o=n(12),s=n.n(o),u=n(16),i=n.n(u),l=n(6),d=n(20),p=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{"Content-Type":"application/json"}},e.next=4,s.a.get("/api/v1/users/me",n);case 4:r=e.sent,t({type:l.e,payload:r.data.data.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error from loading the user",e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},b=function(e,t){return function(){var n=Object(c.a)(a.a.mark((function n(r){var c,o,u;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c={headers:{"Content-Type":"application/json"}},o=JSON.stringify({email:e,password:t}),n.prev=2,n.next=5,s.a.post("/api/v1/users/login",o,c);case 5:u=n.sent,r(Object(d.a)("Success Login","success")),i.a.set("jwt",u.data.token,{expires:7}),r({type:l.e,payload:u.data}),n.next=17;break;case 11:n.prev=11,n.t0=n.catch(2),i.a.remove("jwt"),console.log(n.t0.response),r({type:l.b}),r({type:l.a});case 17:case"end":return n.stop()}}),n,null,[[2,11]])})));return function(e){return n.apply(this,arguments)}}()},j=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{"Content-Type":"application/json"}},c=JSON.stringify(e),t.prev=2,t.next=5,s.a.post("/api/v1/users/signup",c,r);case 5:o=t.sent,n(Object(d.a)("Success Register","success")),i.a.set("jwt",o.data.token,{expires:7}),n({type:l.e,payload:o.data}),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(2),n(Object(d.a)(t.t0.response.data.message,"error")),i.a.remove("jwt"),n({type:l.b}),n({type:l.a});case 17:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()},f=function(){return function(e){i.a.remove("jwt"),e({type:l.f})}},h=function(e,t,n){return function(){var r=Object(c.a)(a.a.mark((function r(c){var o,u;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(o=new FormData).append("photo",n),o.append("name",e),o.append("email",t),r.prev=4,r.next=7,s.a.patch("/api/v1/users/updateMe",o);case 7:u=r.sent,c(Object(d.a)("User Updated Successfully","success")),c({type:l.c,payload:u.data.data.user}),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(4),c(Object(d.a)(r.t0.response.data.message,"error"));case 15:case"end":return r.stop()}}),r,null,[[4,12]])})));return function(e){return r.apply(this,arguments)}}()},O=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={headers:{"Content-Type":"application/json"}},c=JSON.stringify(e),t.prev=2,t.next=5,s.a.patch("/api/v1/users/updateMyPassword",c,r);case 5:o=t.sent,n(Object(d.a)("Password update Success","success")),n({type:l.d,payload:o.data.data.user}),n({type:l.f}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),n(Object(d.a)(t.t0.response.data.message,"error"));case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()}},28:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="SET_ALERT",a="REMOVE_ALERT"},32:function(e,t,n){"use strict";var r=n(12),a=n.n(r);t.a=function(e){e?a.a.defaults.headers.common.authorization="Bearer ".concat(e):delete a.a.defaults.common.authorization}},36:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return f}));var r=n(7),a=n.n(r),c=n(18),o=n(12),s=n.n(o),u=n(61),i=n(15),l=n(32),d=Object(u.a)("pk_test_51JRSF2AJHQSuL36xgVLN3iL6uDsgccyG5gdbXPzBwPb6PXXRGG5LPet9720qWUKB7zJ9Hkar7B4fqXs55txpLiBd00x57dIp8g"),p=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.get("/api/v1/tours");case 3:n=e.sent,t({type:i.c,payload:n.data.data.data}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),t({type:i.e,payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},b=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.get("/api/v1/tour/".concat(e));case 3:r=t.sent,n({type:i.b,payload:r.data.tour}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n({type:i.f,payload:t.t0.response});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},j=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.token&&Object(l.a)(localStorage.token),t.prev=1,t.next=4,s.a.get("/api/v1/bookings/checkout-session/".concat(e));case 4:return r=t.sent,t.next=7,d;case 7:return t.next=9,t.sent.redirectToCheckout({sessionId:r.data.session.id});case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log("SESSION ERROR MESSAGE:",t.t0.response);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()},f=function(){return function(e){localStorage.tour&&e({type:i.d,payload:localStorage.tour})}}},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="GET_BOOKINGS"},56:function(e,t,n){"use strict";t.a=n.p+"static/media/logo-white.6c89a3f0.png"},6:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var r="USER_LOADED",a="UPDATE_CURRENT_USER",c="UPDATE_USER_PASSWORD",o="USER_LOGOUT",s="CLEAR_USER",u="AUTH_ERROR"},76:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var r=n(31),a=n.n(r),c=n(11),o=n(17),s=n(27),u=n(58),i=n(59),l=n(57),d=n(28),p=[];var b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case d.b:return[].concat(Object(l.a)(e),[r]);case d.a:return e.filter((function(e){return e.id!==r}));default:return e}},j=n(4),f=n(6),h={user:null,isAuthenticated:!1};var O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.e:case f.c:case f.d:return Object(j.a)(Object(j.a)({},e),{},{user:t.payload,isAuthenticated:!0});case f.a:case f.b:case f.f:return Object(j.a)(Object(j.a)({},e),{},{user:null,isAuthenticated:!1});default:return e}},v=n(15),g={tours:[],tour:null,toursBooked:null,loading:!0,errors:null};var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.c:return Object(j.a)(Object(j.a)({},e),{},{tours:t.payload,loading:!1,errors:null});case v.b:return Object(j.a)(Object(j.a)({},e),{},{tour:t.payload,errors:null,loading:!1});case v.d:return Object(j.a)(Object(j.a)({},e),{},{tour:JSON.parse(t.payload),errors:null,loading:!1});case v.a:return Object(j.a)(Object(j.a)({},e),{},{toursBooked:t.payload,errors:null,loading:!1});case v.e:return Object(j.a)(Object(j.a)({},e),{},{tours:[],tour:null,errors:t.payload,loading:!1});case v.f:return Object(j.a)(Object(j.a)({},e),{},{tour:null,errors:t.payload,loading:!1});default:return e}},m=n(46),y={toursBooked:null};var k,w,_,S,R,E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;return t.type===m.a?Object(j.a)(Object(j.a)({},e),{},{toursBooked:t.payload}):e},T=Object(s.combineReducers)({tours:x,auth:O,bookings:E,alerts:b}),A=[i.a],U=Object(s.createStore)(T,{},Object(u.composeWithDevTools)(s.applyMiddleware.apply(void 0,A))),N=n(1),C=n.n(N),L=n(5),P=n(16),B=n.n(P),z=(n(76),n.p+"static/media/logo-green.de221e6e.png"),D=n(2),G=function(){return Object(D.jsxs)("div",{className:"footer",children:[Object(D.jsx)("div",{className:"footer__logo",children:Object(D.jsx)(o.b,{to:"/",children:Object(D.jsx)("img",{src:z,alt:"logo"})})}),Object(D.jsxs)("ul",{className:"footer__nav",children:[Object(D.jsx)("li",{children:Object(D.jsx)("a",{href:"#",children:"About us"})}),Object(D.jsx)("li",{children:Object(D.jsx)("a",{href:"#",children:"Download apps"})}),Object(D.jsx)("li",{children:Object(D.jsx)("a",{href:"#",children:"Become a guide"})}),Object(D.jsx)("li",{children:Object(D.jsx)("a",{href:"#",children:"Careers"})}),Object(D.jsx)("li",{children:Object(D.jsx)("a",{href:"#",children:"Contact"})})]}),Object(D.jsx)("p",{className:"footer__copyright",children:"\xa9 by Mohamed Iman Portfolio. All rights reserved."})]})},J=n(66),I=n(21),M=["component","isAuthenticated"],F=Object(c.b)((function(e){return{isAuthenticated:Object(I.b)(e)}}))((function(e){var t=e.component,n=e.isAuthenticated,r=Object(J.a)(e,M);return Object(D.jsx)(L.b,Object(j.a)(Object(j.a)({},r),{},{render:function(e){return n?Object(D.jsx)(t,Object(j.a)({},e)):Object(D.jsx)(L.a,{to:"/login"})}}))})),W=n(36),X=n(26),H=Object(c.b)((function(e){return{alerts:e.alerts}}))((function(e){var t=e.alerts;return null!==t&&t.length>0&&t.map((function(e){return Object(D.jsxs)("div",{className:"alert alert--".concat(e.alertType),children:[" ",e.msg]},e.id)}))})),K=n(29),q=Object(c.b)(null,{logout:X.d})((function(e){var t=e.logout,n=Object(K.b)({isAuthenticated:I.b,user:I.a}),r=Object(c.c)(n),a=r.isAuthenticated,s=r.user,u=Object(D.jsxs)("nav",{className:"nav nav--user",children:[Object(D.jsx)("a",{href:"/",className:"nav__el nav__el--logout",onClick:t,children:"Log Out"}),Object(D.jsxs)(o.b,{to:"/me",className:"nav__el",children:[s&&Object(D.jsx)("img",{src:"/img/users/".concat(s.photo),alt:"user",className:"nav__user-img"}),s&&s.name&&Object(D.jsx)("span",{children:s.name.split(" ")[0]})]})]}),i=Object(D.jsxs)("nav",{className:"nav nav--user",children:[Object(D.jsx)(o.b,{to:"/login",className:"nav__el",children:"Log in"}),Object(D.jsx)(o.b,{to:"/signup",className:"nav__el nav__el--cta",children:"Sign up"})]});return Object(D.jsx)(N.Fragment,{children:a?u:i})})),V=(n(44),n(56)),Q=Object(c.b)((function(e){return{isAuthenticated:Object(I.b)(e)}}),{loadUser:X.b})((function(e){e.isAuthenticated;var t=e.loadUser;return Object(N.useEffect)((function(){B.a.get("jwt")&&(t(),console.log("Called the loadUser"))}),[]),Object(D.jsxs)("header",{className:"header",children:[Object(D.jsx)("a",{href:"/",className:"nav__el",children:"All tours"}),Object(D.jsx)("div",{className:"header__logo",children:Object(D.jsx)("a",{href:"/",children:Object(D.jsx)("img",{src:V.a,alt:"Natours logo"})})}),Object(D.jsx)(q,{})]})})),Y=n(32),Z=n(40),$=n(41),ee=n(67),te=n(65),ne=n(23),re=n(24),ae=re.a.div(k||(k=Object(ne.a)(["\n  height: 60vh;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]))),ce=re.a.div(w||(w=Object(ne.a)(["\n  display: inline-block;\n  background-image: ",";\n  background-size: cover;\n  background-position: center;\n  width: 40vh;\n  height: 40vh;\n"])),(function(e){var t=e.imageUrl;return"url(".concat(t,")")})),oe=re.a.h2(_||(_=Object(ne.a)(["\n  font-size: 28px;\n  color: #2f8e89;\n"]))),se=function(e){Object(ee.a)(n,e);var t=Object(te.a)(n);function n(){var e;return Object(Z.a)(this,n),(e=t.call(this)).state={hasErrored:!1},e}return Object($.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e)}},{key:"render",value:function(){return this.state.hasErrored?Object(D.jsxs)(ae,{children:[Object(D.jsx)(ce,{imageUrl:"https://i.imgur.com/yW2W9SC.png"}),Object(D.jsx)(oe,{children:"Sorry this page is broken"})]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasErrored:!0}}}]),n}(C.a.Component),ue=re.a.div(S||(S=Object(ne.a)(["\n  height: 60vh;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),ie=re.a.div(R||(R=Object(ne.a)(["\n  display: inline-block;\n  width: 50px;\n  height: 50px;\n  border: 3px solid rgba(195, 195, 195, 0.6);\n  border-radius: 50%;\n  border-top-color: #636767;\n  animation: spin 1s ease-in-out infinite;\n  -webkit-animation: spin 1s ease-in-out infinite;\n  @keyframes spin {\n    to {\n      -webkit-transform: rotate(360deg);\n    }\n  }\n  @-webkit-keyframes spin {\n    to {\n      -webkit-transform: rotate(360deg);\n    }\n  }\n"]))),le=function(){return Object(D.jsx)(ue,{children:Object(D.jsx)(ie,{})})},de=Object(N.lazy)((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,125))})),pe=Object(N.lazy)((function(){return Promise.all([n.e(0),n.e(4),n.e(10)]).then(n.bind(null,128))})),be=Object(N.lazy)((function(){return n.e(7).then(n.bind(null,126))})),je=Object(N.lazy)((function(){return n.e(8).then(n.bind(null,127))})),fe=Object(N.lazy)((function(){return Promise.all([n.e(5),n.e(11)]).then(n.bind(null,129))})),he=Object(N.lazy)((function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,130))})),Oe=Object(c.b)(null,{loadUser:X.b,getAllTours:W.b,loadTour:W.d})((function(e){var t=e.loadUser,n=e.getAllTours,r=e.loadTour;return B.a.get("jwt")&&(Object(Y.a)(B.a.get("jwt")),t()),Object(N.useEffect)((function(){n(),r()}),[]),Object(D.jsxs)(N.Fragment,{children:[Object(D.jsx)(Q,{}),Object(D.jsx)(H,{}),Object(D.jsx)(L.d,{children:Object(D.jsx)(se,{children:Object(D.jsxs)(N.Suspense,{fallback:le,children:[Object(D.jsx)(F,{exact:!0,path:"/me",component:fe}),Object(D.jsx)(F,{exact:!0,path:"/bookings/my-tours",component:he}),Object(D.jsx)(L.b,{exact:!0,path:"/",component:de}),Object(D.jsx)(L.b,{exact:!0,path:"/tour/:slug",component:pe}),Object(D.jsx)(L.b,{exact:!0,path:"/login",component:be}),Object(D.jsx)(L.b,{exact:!0,path:"/signup",component:je})]})})}),Object(D.jsx)(G,{})]})}));a.a.render(Object(D.jsx)(c.a,{store:U,children:Object(D.jsx)(o.a,{children:Object(D.jsx)(Oe,{})})}),document.getElementById("root"))}},[[98,2,3]]]);
//# sourceMappingURL=main.efcca6ba.chunk.js.map