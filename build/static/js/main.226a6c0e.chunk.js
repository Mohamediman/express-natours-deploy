(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var s=a(36),r=a.n(s),c=a(2),n=a(10),o=a(11),i=a(16),l=a.n(i),d=a(8),j=a(9),u=a.n(j),b=a(17),m=a(15),h=a.n(m),p="GET_TOURS",O="GET_TOUR",x="TOUR_ERRORS",g="TOURS_ERRORS",v="LOAD_TOUR",_="USER_LOADED",f="UPDATE_CURRENT_USER",N="UPDATE_USER_PASSWORD",w="BOOKTOUR",y="USER_LOGOUT",k="CLEAR_USER",S="AUTH_ERROR",A="SET_ALERT",T="REMOVE_ALERT",R="BOOKING_ERROR",C=a(101),E=function(e,t){return function(a){var s=Object(C.a)();console.log("Set Alert called here.."),a({type:A,payload:{msg:e,alertType:t,id:s}}),setTimeout((function(){return a({type:T,payload:s})}),5e3)}},P=a(1),L=Object(d.b)((function(e){return{auth:e.auth}}),{logout:function(){return function(e){console.log("LOgout called from the link...."),console.log("Remove the jwt from the broweer..."),l.a.remove("jwt"),e({type:y})}}})((function(e){var t=e.auth,a=t.isAuthenticated,s=t.user,r=e.logout,o=Object(P.jsxs)("nav",{className:"nav nav--user",children:[Object(P.jsx)("a",{href:"/",className:"nav__el nav__el--logout",onClick:r,children:"Log Out"}),Object(P.jsxs)(n.b,{to:"/me",className:"nav__el",children:[s&&Object(P.jsx)("img",{src:"/img/users/".concat(s.photo),alt:"user",className:"nav__user-img"}),s&&s.name&&Object(P.jsx)("span",{children:s.name.split(" ")[0]})]})]}),i=Object(P.jsxs)("nav",{className:"nav nav--user",children:[Object(P.jsx)(n.b,{to:"/login",className:"nav__el",children:"Log in"}),Object(P.jsx)(n.b,{to:"/signup",className:"nav__el nav__el--cta",children:"Sign up"})]});return Object(P.jsx)(c.Fragment,{children:a?o:i})})),U=a(26),B=a.p+"static/media/logo-white.6c89a3f0.png",q=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}),{loadUser:function(){return function(){var e=Object(b.a)(u.a.mark((function e(t){var a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={headers:{"Content-Type":"application/json"}},e.next=4,h.a.get("/api/v1/users/me",a);case 4:s=e.sent,t({type:_,payload:s.data.data.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error from loading the user",e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}})((function(e){e.isAuthenticated;var t=e.loadUser;return Object(c.useEffect)((function(){l.a.get("jwt")&&(t(),console.log("Called the loadUser"))}),[]),Object(P.jsxs)("header",{className:"header",children:[Object(P.jsx)("a",{href:"/",className:"nav__el",children:"All tours"}),Object(P.jsx)("div",{className:"header__logo",children:Object(P.jsx)("a",{href:"/",children:Object(P.jsx)("img",{src:B,alt:"Natours logo"})})}),Object(P.jsx)(L,{})]})})),D=a(39),M=a.n(D),F=a(29),I=a(22),Y=Object(d.b)(null)((function(e){var t=e.tour;return Object(P.jsxs)("div",{className:"card",children:[Object(P.jsxs)("div",{className:"card__header",children:[Object(P.jsxs)("div",{className:"card__picture",children:[Object(P.jsx)("div",{className:"card__picture-overlay",children:"\xa0"}),Object(P.jsx)("img",{src:"/img/tours/".concat(t.imageCover),alt:t.name,className:"card__picture-img"})]}),Object(P.jsx)("h3",{className:"heading-tertirary",children:Object(P.jsx)("span",{children:t.name})})]}),Object(P.jsxs)("div",{className:"card__details",children:[Object(P.jsxs)("h4",{className:"card__sub-heading",children:[t.difficulty," ",t.duration,"-day tour"]}),Object(P.jsx)("p",{className:"card__text",children:t.summary}),Object(P.jsxs)("div",{className:"card__data",children:[Object(P.jsx)(F.b,{className:"card__icon"}),Object(P.jsx)("span",{children:t.startLocation.description})]}),Object(P.jsxs)("div",{className:"card__data",children:[Object(P.jsx)(I.a,{className:"card__icon"}),Object(P.jsx)("span",{children:Object(P.jsx)(M.a,{format:"MMM YYYY",children:t.startDates[0]})})]}),Object(P.jsxs)("div",{className:"card__data",children:[Object(P.jsx)(U.a,{className:"card__icon"}),Object(P.jsxs)("span",{children:[t.locations.length," stops"]})]}),Object(P.jsxs)("div",{className:"card__data",children:[Object(P.jsx)(U.b,{className:"card__icon"}),Object(P.jsxs)("span",{children:[t.maxGroupSize," people"]})]})]}),Object(P.jsxs)("div",{className:"card__footer",children:[Object(P.jsxs)("p",{children:[Object(P.jsxs)("span",{className:"card__footer-value",children:["$",t.price]}),Object(P.jsx)("span",{className:"card__footer-text",children:"per person"})]}),Object(P.jsxs)("p",{className:"card__ratings",children:[Object(P.jsx)("span",{className:"card__footer-value",children:t.ratingsAverage}),Object(P.jsxs)("span",{className:"card__footer-text",children:["rating (",t.ratingsQuantity,")"]})]}),Object(P.jsx)(n.b,{to:"/tour/".concat(t.slug),className:"btn btn--green btn--small",children:"Details"})]})]})})),J=Object(d.b)((function(e){return{tours:e.tours.tours}}))((function(e){var t=e.tours;return Object(P.jsx)("main",{className:"main",children:Object(P.jsx)("div",{className:"card-container",children:t&&t.length>0&&t.map((function(e){return Object(P.jsx)(Y,{tour:e},e._id)}))})})})),G=function(e){var t=e.tour;return Object(P.jsxs)("section",{className:"section-header",children:[Object(P.jsxs)("div",{className:"header__hero",children:[Object(P.jsx)("div",{className:"header__hero-overlay",children:"\xa0 "}),Object(P.jsx)("img",{src:"/img/tours/".concat(t.imageCover),alt:t.name,className:"header__hero-img"})]}),Object(P.jsxs)("div",{className:"heading-box",children:[Object(P.jsx)("h1",{className:"heading-primary",children:Object(P.jsxs)("span",{children:[t&&t.name.split(" ").splice(0,2).join(" "),Object(P.jsx)("br",{}),t&&t.name.split(" ").splice(2).join("")]})}),Object(P.jsxs)("div",{className:"heading-box__group",children:[Object(P.jsxs)("div",{className:"heading-box__detail",children:[Object(P.jsx)(F.a,{className:"heading-box__icon"}),Object(P.jsxs)("span",{className:"heading-box__text",children:[t&&t.duration," days"]})]}),Object(P.jsxs)("div",{className:"heading-box__detail",children:[Object(P.jsx)(F.b,{className:"heading-box__icon"}),Object(P.jsxs)("span",{className:"heading-box__text",children:[" ",t&&t.startLocation.description]})]})]})]})]})},z=function(e){var t=e.tour;return Object(P.jsxs)("div",{className:"description-box",children:[Object(P.jsxs)("h2",{className:"heading-secondary ma-bt-lg",children:["About ",t.name," "]}),Object(P.jsx)("p",{className:"description__text",children:t.description&&t.description.split(".").splice(0,2)}),Object(P.jsx)("p",{className:"description__text",children:t.description&&t.description.split(".").splice(2)})]})},W=function(e){var t=e.guide;return Object(P.jsxs)("div",{className:"overview-box__detail",children:[Object(P.jsx)("img",{src:"/img/users/".concat(t.photo),alt:t.role,className:"overview-box__img"}),Object(P.jsx)("span",{className:"overview-box__label",children:t.role}),Object(P.jsx)("span",{className:"overview-box__text",children:t.name})]})},Q=function(e){var t=e.tour;return Object(P.jsx)("div",{className:"overview-box",children:Object(P.jsxs)("div",{children:[Object(P.jsxs)("div",{className:"overview-box__group",children:[Object(P.jsx)("h2",{className:"heading-secondary ma-bt-lg",children:"Quick facts"}),Object(P.jsxs)("div",{className:"overview-box__detail",children:[Object(P.jsx)(I.a,{className:"overview-box__icon"}),Object(P.jsx)("span",{className:"overview-box__label",children:"Next date"}),Object(P.jsx)("span",{className:"overview-box__text",children:Object(P.jsx)(M.a,{format:"MMM YYYY",children:t.startDates[0]})})]}),Object(P.jsxs)("div",{className:"overview-box__detail",children:[Object(P.jsx)(I.c,{className:"overview-box__icon"}),Object(P.jsx)("span",{className:"overview-box__label",children:"Difficulty"}),Object(P.jsx)("span",{className:"overview-box__text",children:t.difficulty})]}),Object(P.jsxs)("div",{className:"overview-box__detail",children:[Object(P.jsx)(U.b,{className:"overview-box__icon"}),Object(P.jsx)("span",{className:"overview-box__label",children:"Participants"}),Object(P.jsxs)("span",{className:"overview-box__text",children:[t.maxGroupSize," people"]})]}),Object(P.jsxs)("div",{className:"overview-box__detail",children:[Object(P.jsx)(I.b,{className:"overview-box__icon"}),Object(P.jsx)("span",{className:"overview-box__label",children:"Rating"}),Object(P.jsxs)("span",{className:"overview-box__text",children:[t.ratingsAverage," / 5"]})]})]}),Object(P.jsxs)("div",{className:"overview-box__group",children:[Object(P.jsx)("h2",{className:"heading-secondary ma-bt-lg",children:"Your tour guides"}),t.guides.map((function(e){return Object(P.jsx)(W,{guide:e},e._id)}))]})]})})},H=function(e){var t=e.review;return Object(P.jsxs)("div",{className:"reviews__card",children:[Object(P.jsxs)("div",{className:"reviews__avatar",children:[Object(P.jsx)("img",{src:"/img/users/".concat(t.user.photo),alt:t.user.name,className:"reviews__avatar-img"}),Object(P.jsx)("h6",{className:"reviews__user",children:t.user.name})]}),Object(P.jsx)("p",{className:"reviews__text",children:t.review}),Object(P.jsxs)("div",{className:"reviews__rating",children:[Object(P.jsx)(I.b,{className:"reviews__star ".concat(t.rating>=1&&"reviews__star--active"," ")}),Object(P.jsx)(I.b,{className:"reviews__star ".concat(t.rating>=2&&"reviews__star--active"," ")}),Object(P.jsx)(I.b,{className:"reviews__star ".concat(t.rating>=3&&"reviews__star--active"," ")}),Object(P.jsx)(I.b,{className:"reviews__star ".concat(t.rating>=4&&"reviews__star--active"," ")}),Object(P.jsx)(I.b,{className:"reviews__star ".concat(t.rating>=5&&"reviews__star--active"," ")})]})]})},V=function(e){var t=e.image;return Object(P.jsx)("div",{className:"picture-box",children:Object(P.jsx)("img",{className:"picture-box__img picture-box__img--1",src:"/img/tours/".concat(t),alt:t})})},X=a(5),K=a(7),Z=a(46),$=function(e){var t=e.tour;t&&(Number(t.locations[0].coordinates[0]),Number(t.locations[0].coordinates[1]));var a=Object(c.useState)({latitude:34.011646,longitude:-116.107963,zoom:5}),s=Object(K.a)(a,2),r=s[0],n=s[1];return t&&t.locations?Object(P.jsx)(Z.b,Object(X.a)(Object(X.a)({mapStyle:"mapbox://styles/mohamedai/ckskl74tv0ell17rk4x53odnj",mapboxApiAccessToken:"pk.eyJ1IjoibW9oYW1lZGFpIiwiYSI6ImNrc2tqNHFqYTJvN2wybm9hdnJreTdvaTMifQ.WLNcgVIG5MDN9gxqQ88a8A"},r),{},{width:"100%",height:"100%",scrollZoom:!1,onViewportChange:function(e){return n(e)},children:t.locations.map((function(e){var t=Number(e.coordinates[0]),a=Number(e.coordinates[1]);return Object(P.jsx)(Z.a,{latitude:a,longitude:t,offsetLeft:-20,offsetTop:-10,children:Object(P.jsx)("div",{className:"marker"},t*a)})}))})):Object(P.jsx)(c.Fragment,{children:Object(P.jsx)("h1",{children:"No Tour found"})})},ee=a(62),te=function(e){e?h.a.defaults.headers.common.authorization="Bearer ".concat(e):delete h.a.defaults.common.authorization},ae=Object(ee.a)("pk_test_51JRSF2AJHQSuL36xgVLN3iL6uDsgccyG5gdbXPzBwPb6PXXRGG5LPet9720qWUKB7zJ9Hkar7B4fqXs55txpLiBd00x57dIp8g"),se=Object(d.b)((function(e){return{tours:e.tours,user:e.auth.user}}),{bookTour:function(e){return function(){var t=Object(b.a)(u.a.mark((function t(a){var s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.token&&te(localStorage.token),t.prev=1,t.next=4,h.a.get("/api/v1/bookings/checkout-session/".concat(e));case 4:return s=t.sent,t.next=7,ae;case 7:return t.next=9,t.sent.redirectToCheckout({sessionId:s.data.session.id});case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0.response);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()},getTour:function(e){return function(){var t=Object(b.a)(u.a.mark((function t(a){var s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.a.get("/api/v1/tour/".concat(e));case 3:s=t.sent,a({type:O,payload:s.data.tour}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a({type:x,payload:t.t0.response});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.match,a=e.tours,s=a.tour,r=a.loading,n=e.user,o=e.bookTour,i=e.getTour;return Object(c.useEffect)((function(){i(t.params.slug)}),[]),Object(P.jsxs)(c.Fragment,{children:[s&&!r&&Object(P.jsx)(G,{tour:s}),Object(P.jsxs)("section",{className:"section-description",children:[s&&!r&&Object(P.jsx)(Q,{tour:s}),s&&Object(P.jsx)(z,{tour:s})]}),Object(P.jsx)("section",{className:"section-pictures",children:s&&!r&&s.images.length>0&&s.images.map((function(e){var t=Object(C.a)();return Object(P.jsx)(V,{image:e},t)}))}),s&&Object(P.jsxs)("section",{className:"section-map",children:[Object(P.jsx)("div",{id:"map"}),Object(P.jsx)($,{tour:s})]}),Object(P.jsx)("section",{className:"section-reviews",children:Object(P.jsx)("div",{className:"reviews",children:s&&!r&&s.reviews.length>0&&s.reviews.map((function(e){return Object(P.jsx)(H,{review:e},e._id)}))})}),Object(P.jsx)("section",{className:"section-cta",children:s&&!r&&Object(P.jsxs)("div",{className:"cta",children:[Object(P.jsx)("div",{className:"cta__img cta__img--logo",children:Object(P.jsx)("img",{src:B,alt:"Natours logo"})}),Object(P.jsx)("img",{src:"/img/tours/tour-5-2.jpg",alt:"natours",className:"cta__img cta__img--1"}),Object(P.jsx)("img",{src:"/img/tours/tour-5-1.jpg",alt:"natours images",className:"cta__img cta__img--2"}),Object(P.jsxs)("div",{className:"cta__content",children:[Object(P.jsx)("h2",{className:"heading-secondary",children:"What are you waiting for?"}),Object(P.jsxs)("p",{className:"cta__text",children:[s&&s.duration," days. 1 adventure. Infinite memories. Make it yours today!"]}),n?Object(P.jsx)("button",{className:"btn btn--green span-all-rows",onClick:function(e){return o(s.id)},children:"Book tour now!"}):Object(P.jsx)("a",{href:"/login",className:"btn btn--green span-all-rows",children:"Login to Book tour"})]})]})})]})})),re=a(24),ce=Object(d.b)((function(e){return{alerts:e.alerts}}))((function(e){var t=e.alerts;return null!==t&&t.length>0&&t.map((function(e){return Object(P.jsxs)("div",{className:"alert alert--".concat(e.alertType),children:[" ",e.msg]},e.id)}))})),ne=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}),{login:function(e,t){return function(){var a=Object(b.a)(u.a.mark((function a(s){var r,c,n;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r={headers:{"Content-Type":"application/json"}},c=JSON.stringify({email:e,password:t}),a.prev=2,a.next=5,h.a.post("/api/v1/users/login",c,r);case 5:n=a.sent,s(E("Success Login","success")),l.a.set("jwt",n.data.token,{expires:7}),s({type:_,payload:n.data}),a.next=17;break;case 11:a.prev=11,a.t0=a.catch(2),l.a.remove("jwt"),console.log(a.t0.response),s({type:k}),s({type:S});case 17:case"end":return a.stop()}}),a,null,[[2,11]])})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.login,a=e.isAuthenticated,s=Object(c.useState)({email:"",password:""}),r=Object(K.a)(s,2),n=r[0],i=r[1],l=n.email,d=n.password,j=function(e){i(Object(X.a)(Object(X.a)({},n),{},Object(re.a)({},e.target.name,e.target.value)))};return a?Object(P.jsx)(o.a,{to:"/"}):Object(P.jsxs)("div",{className:"login-form",children:[Object(P.jsx)("h2",{className:"heading-secondary ma-bt-lg",children:"Login into your account"}),Object(P.jsxs)("form",{className:"form form--login",onSubmit:function(e){return function(e){e.preventDefault(),t(l,d)}(e)},children:[Object(P.jsxs)("div",{className:"form__group",children:[Object(P.jsx)("label",{htmlFor:"email",className:"form__label",children:"Enter email address"}),Object(P.jsx)("input",{type:"email",id:"email",name:"email",className:"form__input",onChange:function(e){return j(e)},placeholder:"youremail@email.com",required:!0})]}),Object(P.jsxs)("div",{className:"form__group ma-bt-md",children:[Object(P.jsx)("label",{htmlFor:"password",className:"form__label",children:"Password"}),Object(P.jsx)("input",{type:"password",id:"password",className:"form__input",name:"password",onChange:function(e){return j(e)},placeholder:"........",required:!0,minLength:"8"})]}),Object(P.jsx)("div",{className:"form__group",children:Object(P.jsx)("button",{className:"btn btn--green",children:"Login"})})]})]})})),oe=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}),{register:function(e){return function(){var t=Object(b.a)(u.a.mark((function t(a){var s,r,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={headers:{"Content-Type":"application/json"}},r=JSON.stringify(e),t.prev=2,t.next=5,h.a.post("/api/v1/users/signup",r,s);case 5:c=t.sent,a(E("Success Register","success")),l.a.set("jwt",c.data.token,{expires:7}),a({type:_,payload:c.data}),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(2),a(E(t.t0.response.data.message,"error")),l.a.remove("jwt"),a({type:k}),a({type:S});case 17:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()},setAlert:E})((function(e){var t=e.isAuthenticated,a=e.register,s=e.setAlert,r=Object(c.useState)({name:"",email:"",password:"",confirmPassword:""}),n=Object(K.a)(r,2),i=n[0],l=n[1],d=i.name,j=i.email,m=i.password,h=i.confirmPassword,p=function(e){l(Object(X.a)(Object(X.a)({},i),{},Object(re.a)({},e.target.name,e.target.value)))},O=function(){var e=Object(b.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),m!==h?s("Passwords do not match","error"):(r={name:d,email:j,password:m,confirmPassword:h},s("Success Registration","success"),a(r));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t?Object(P.jsx)(o.a,{to:"/"}):Object(P.jsxs)("div",{className:"login-form",children:[Object(P.jsx)("h2",{className:"heading-secondary ma-bt-lg",children:"Singup"}),Object(P.jsxs)("form",{className:"form form--login",onSubmit:function(e){return O(e)},children:[Object(P.jsxs)("div",{className:"form__group",children:[Object(P.jsx)("label",{htmlFor:"name",className:"form__label",children:"Name"}),Object(P.jsx)("input",{type:"name",id:"name",className:"form__input",name:"name",onChange:function(e){return p(e)},placeholder:"your name",required:!0})]}),Object(P.jsxs)("div",{className:"form__group",children:[Object(P.jsx)("label",{htmlFor:"email",className:"form__label",children:"Enter email address"}),Object(P.jsx)("input",{type:"email",id:"email",className:"form__input",name:"email",onChange:function(e){return p(e)},placeholder:"youremail@email.com",required:!0})]}),Object(P.jsxs)("div",{className:"form__group ma-bt-md",children:[Object(P.jsx)("label",{htmlFor:"password",className:"form__label",children:"Password"}),Object(P.jsx)("input",{type:"password",id:"password",className:"form__input",name:"password",onChange:function(e){return p(e)},placeholder:"........",required:!0,minLength:"8"})]}),Object(P.jsxs)("div",{className:"form__group ma-bt-md",children:[Object(P.jsx)("label",{htmlFor:"confirmPassword",className:"form__label",children:"Confirm Password"}),Object(P.jsx)("input",{type:"password",id:"confirmPassword",className:"form__input",name:"confirmPassword",onChange:function(e){return p(e)},placeholder:"........",required:!0,minLength:"8"})]}),Object(P.jsx)("div",{className:"form__group",children:Object(P.jsx)("button",{className:"btn btn--green",children:"Signup"})})]})]})})),ie=a(25),le=function(){return Object(P.jsxs)("nav",{className:"user-view__menu",children:[Object(P.jsxs)("ul",{className:"side-nav",children:[Object(P.jsx)("li",{className:"side-nav--active",children:Object(P.jsxs)(n.b,{to:"#",children:[" ",Object(P.jsx)(ie.c,{}),"Settings"]})}),Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"/bookings/my-tours",children:[Object(P.jsx)(ie.b,{}),"My Bookings"]})}),Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"#",children:[" ",Object(P.jsx)(ie.e,{}),"My Reviews"]})}),Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"#",children:[Object(P.jsx)(ie.a,{}),"Billing"]})})]}),Object(P.jsxs)("div",{className:"admin-nav",children:[Object(P.jsx)("h5",{className:"admin-nav__heading",children:"Admin"}),Object(P.jsxs)("ul",{className:"side-nav",children:[Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"#",children:[" ",Object(P.jsx)(ie.d,{}),"Manage tours"]})}),Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"#",children:[" ",Object(P.jsx)(ie.f,{}),"Manage users"]})}),Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"#",children:[Object(P.jsx)(ie.e,{}),"Manage reviews"]})}),Object(P.jsx)("li",{children:Object(P.jsxs)(n.b,{to:"#",children:[Object(P.jsx)(ie.b,{}),"Manage Bookings"]})})]})]})]})},de=a(63),je=a.n(de),ue=Object(d.b)((function(e){return{user:e.auth.user}}),{updateCurrentUser:function(e,t,a){return function(){var s=Object(b.a)(u.a.mark((function s(r){var c,n;return u.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(c=new FormData).append("photo",a),c.append("name",e),c.append("email",t),s.prev=4,s.next=7,h.a.patch("/api/v1/users/updateMe",c);case 7:n=s.sent,r(E("User Updated Successfully","success")),r({type:f,payload:n.data.data.user}),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(4),r(E(s.t0.response.data.message,"error"));case 15:case"end":return s.stop()}}),s,null,[[4,12]])})));return function(e){return s.apply(this,arguments)}}()}})((function(e){var t=e.user,a=e.updateCurrentUser,s=Object(c.useState)({name:"",email:""}),r=Object(K.a)(s,2),n=r[0],o=r[1],i=Object(c.useState)(""),l=Object(K.a)(i,2),d=l[0],j=l[1],u=n.name,b=n.email,m=function(e){return o(Object(X.a)(Object(X.a)({},n),{},Object(re.a)({},e.target.name,e.target.value)))};return Object(P.jsxs)("div",{className:"user-view__form-container",children:[Object(P.jsx)("h2",{className:"heading-secondary ma-bt-md",children:"Your account settings"}),Object(P.jsxs)("form",{className:"form form-user-data",onSubmit:function(e){return function(e){e.preventDefault(),a(u,b,d)}(e)},children:[Object(P.jsxs)("div",{className:"form__group",children:[Object(P.jsx)("label",{className:"form__label",htmlFor:"name",children:"Name"}),Object(P.jsx)("input",{className:"form__input",id:"name",name:"name",type:"text",placeholder:t.name,onChange:function(e){return m(e)},required:"required"})]}),Object(P.jsxs)("div",{className:"form__group ma-bt-md",children:[Object(P.jsx)("label",{className:"form__label",htmlFor:"email",children:"Email address"}),Object(P.jsx)("input",{className:"form__input",id:"email",name:"email",type:"email",placeholder:t.email,onChange:function(e){return m(e)},required:"required"})]}),Object(P.jsxs)("div",{className:"form__group form__photo-upload",children:[Object(P.jsx)("img",{className:"form__user-photo",src:"/img/users/".concat(t.photo),alt:"User photo"}),Object(P.jsx)(je.a,{multiple:!0,value:d,onChange:function(e){j(e[0].file)},children:function(e){e.photo;var t=e.onImageUpload;return Object(P.jsx)("div",{className:"upload__image-wrapper",children:Object(P.jsx)("label",{className:"form__label",onClick:t,children:"Upload Image"})})}})]}),Object(P.jsx)("div",{className:"form__group right",children:Object(P.jsx)("button",{className:"btn btn--small btn--green",children:"Save settings"})})]})]})})),be=Object(d.b)(null,{setAlert:E,changePassword:function(e){return function(){var t=Object(b.a)(u.a.mark((function t(a){var s,r,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={headers:{"Content-Type":"application/json"}},r=JSON.stringify(e),t.prev=2,t.next=5,h.a.patch("/api/v1/users/updateMyPassword",r,s);case 5:c=t.sent,a(E("Password update Success","success")),a({type:N,payload:c.data.data.user}),a({type:y}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),a(E(t.t0.response.data.message,"error"));case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.setAlert,a=e.changePassword,s=Object(c.useState)({oldPassword:"",password:"",confirmPassword:""}),r=Object(K.a)(s,2),n=r[0],o=r[1],i=n.oldPassword,l=n.password,d=n.confirmPassword,j=function(e){return o(Object(X.a)(Object(X.a)({},n),{},Object(re.a)({},e.target.name,e.target.value)))};return Object(P.jsxs)("div",{className:"user-view__form-container",children:[Object(P.jsx)("h2",{className:"heading-secondary ma-bt-md",children:"Password change"}),Object(P.jsxs)("form",{className:"form form-user-settings",onSubmit:function(e){return function(e){if(e.preventDefault(),""===i)t("The current password is required","error");else if(l!==d)t("The new passwords do not match","error");else{var s=Object(X.a)({},n);a(s)}}(e)},children:[Object(P.jsxs)("div",{className:"form__group",children:[Object(P.jsx)("label",{className:"form__label",htmlFor:"oldPassword",children:"Current password"}),Object(P.jsx)("input",{className:"form__input",name:"oldPassword",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",onChange:function(e){return j(e)},required:"required",minLength:"8"})]}),Object(P.jsxs)("div",{className:"form__group",children:[Object(P.jsx)("label",{className:"form__label",htmlFor:"password",children:"New password"}),Object(P.jsx)("input",{className:"form__input",name:"password",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",onChange:function(e){return j(e)},required:"required",minLength:"8"})]}),Object(P.jsxs)("div",{className:"form__group ma-bt-lg",children:[Object(P.jsx)("label",{className:"form__label",htmlFor:"confirmPassword",children:"Confirm password"}),Object(P.jsx)("input",{className:"form__input",name:"confirmPassword",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",onChange:function(e){return j(e)},required:"required",minLength:"8"})]}),Object(P.jsx)("div",{className:"form__group right",children:Object(P.jsx)("button",{className:"btn btn--small btn--green",children:"Save password"})})]})]})})),me=function(){return Object(P.jsx)("main",{className:"main",children:Object(P.jsxs)("div",{className:"user-view",children:[Object(P.jsx)(le,{}),Object(P.jsxs)("div",{className:"user-view__content",children:[Object(P.jsx)(ue,{}),Object(P.jsx)("div",{className:"line",children:"\xa0"}),Object(P.jsx)(be,{})]})]})})},he=Object(d.b)(null,{createBooking:function(e,t,a){return function(){var s=Object(b.a)(u.a.mark((function s(r){var c;return u.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,{headers:{"Content-Type":"application/json"}},s.next=4,h.a.get("/api/v1/bookings/my-tours/".concat(e,"/").concat(t,"/").concat(a));case 4:c=s.sent,console.log("CreateBookings:",c.data),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.log("CreateBookings Error:",s.t0.response.data.message);case 11:case"end":return s.stop()}}),s,null,[[0,8]])})));return function(e){return s.apply(this,arguments)}}()}})((function(e){var t=e.createBooking,a=e.match;return Object(c.useEffect)((function(){var e=a.params.tourId,s=a.params.userId,r=a.params.price;console.log(e,s,r),t(e,s,r)})),console.log("window pathname:",window.location.pathname),Object(P.jsx)("div",{children:Object(P.jsx)("h1",{children:"Booking Success"})})})),pe=Object(d.b)((function(e){return{tours:e.bookings.toursBooked}}),{getAllBooking:function(){return function(){var e=Object(b.a)(u.a.mark((function e(t){var a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,h.a.get("/api/v1/bookings/my-tours",a);case 4:s=e.sent,console.log("my bookings from res.data:",s.data),console.log("my bookings from res.data.tours:",s.data.tours),t({type:R,payload:s.data.tours}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("my bookings Error:",e.t0.response.data.message);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()}})((function(e){var t=e.getAllBooking,a=e.tours;return Object(c.useEffect)((function(){t()}),[]),Object(P.jsx)("main",{className:"main",children:Object(P.jsx)("div",{className:"card-container",children:a&&a.length>0&&a.map((function(e){return Object(P.jsx)(Y,{tour:e},e._id)}))})})})),Oe=a.p+"static/media/logo-green.de221e6e.png",xe=function(){return Object(P.jsxs)("div",{className:"footer",children:[Object(P.jsx)("div",{className:"footer__logo",children:Object(P.jsx)(n.b,{to:"/",children:Object(P.jsx)("img",{src:Oe,alt:"logo"})})}),Object(P.jsxs)("ul",{className:"footer__nav",children:[Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"About us"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Download apps"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Become a guide"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Careers"})}),Object(P.jsx)("li",{children:Object(P.jsx)("a",{href:"#",children:"Contact"})})]}),Object(P.jsx)("p",{className:"footer__copyright",children:"\xa9 by Mohamed Iman Portfolio. All rights reserved."})]})},ge=a(66),ve=["component","auth"],_e=Object(d.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.component,a=e.auth.isAuthenticated,s=Object(ge.a)(e,ve);return Object(P.jsx)(o.b,Object(X.a)(Object(X.a)({},s),{},{render:function(e){return a?Object(P.jsx)(t,Object(X.a)({},e)):Object(P.jsx)(o.a,{to:"/login"})}}))})),fe=a(31),Ne=a(64),we=a(65),ye=a(27),ke=[],Se={user:null,isAuthenticated:!1};var Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:case f:case N:return Object(X.a)(Object(X.a)({},e),{},{user:t.payload,isAuthenticated:!0});case S:case k:case y:return Object(X.a)(Object(X.a)({},e),{},{user:null,isAuthenticated:!1});default:return e}},Te={tours:[],tour:null,toursBooked:null,loading:!0,errors:null},Re={toursBooked:null},Ce=Object(fe.combineReducers)({tours:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(X.a)(Object(X.a)({},e),{},{tours:t.payload,loading:!1,errors:null});case O:return Object(X.a)(Object(X.a)({},e),{},{tour:t.payload,errors:null,loading:!1});case v:return Object(X.a)(Object(X.a)({},e),{},{tour:JSON.parse(t.payload),errors:null,loading:!1});case w:return Object(X.a)(Object(X.a)({},e),{},{toursBooked:t.payload,errors:null,loading:!1});case g:return Object(X.a)(Object(X.a)({},e),{},{tours:[],tour:null,errors:t.payload,loading:!1});case x:return Object(X.a)(Object(X.a)({},e),{},{tour:null,errors:t.payload,loading:!1});default:return e}},auth:Ae,bookings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;return t.type===R?Object(X.a)(Object(X.a)({},e),{},{toursBooked:t.payload}):e},alerts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0,a=t.type,s=t.payload;switch(a){case A:return[].concat(Object(ye.a)(e),[s]);case T:return e.filter((function(e){return e.id!==s}));default:return e}}}),Ee=[we.a],Pe=Object(fe.createStore)(Ce,{},Object(Ne.composeWithDevTools)(fe.applyMiddleware.apply(void 0,Ee))),Le=(a(99),function(){return console.log("get cookie without passing a name:",l.a.get()),console.log("jwt cookie using get cookie:",l.a.get("jwt")),console.log("Document cookies:",document.cookie),l.a.get("jwt")&&(console.log("cookies under the if"),console.log(l.a.get("jwt")),te(l.a.get("jwt"))),Object(c.useEffect)((function(){Pe.dispatch(function(){var e=Object(b.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("/api/v1/tours");case 3:a=e.sent,t({type:p,payload:a.data.data.data}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),t({type:g,payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),Pe.dispatch((function(e){localStorage.tour&&e({type:v,payload:localStorage.tour})}))}),[]),Object(P.jsx)(d.a,{store:Pe,children:Object(P.jsxs)(n.a,{children:[Object(P.jsx)(q,{}),Object(P.jsx)(ce,{}),Object(P.jsxs)(o.d,{children:[Object(P.jsx)(_e,{exact:!0,path:"/me",component:me}),Object(P.jsx)(_e,{exact:!0,path:"/bookings/my-tours",component:pe}),Object(P.jsx)(o.b,{exact:!0,path:"my-tours/:tourId/:userId/:price",component:he}),Object(P.jsx)(o.b,{exact:!0,path:"/my-tours",component:he}),Object(P.jsx)(o.b,{exact:!0,path:"/",component:J}),Object(P.jsx)(o.b,{exact:!0,path:"/tour/:slug",component:se}),Object(P.jsx)(o.b,{exact:!0,path:"/login",component:ne}),Object(P.jsx)(o.b,{exact:!0,path:"/signup",component:oe})]}),Object(P.jsx)(xe,{})]})})});r.a.render(Object(P.jsx)(Le,{}),document.getElementById("root"))},99:function(e,t,a){}},[[100,1,2]]]);
//# sourceMappingURL=main.226a6c0e.chunk.js.map